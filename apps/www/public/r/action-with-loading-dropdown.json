{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "action-with-loading-dropdown",
  "type": "registry:component",
  "title": "Action with Loading Dropdown",
  "description": "A dropdown menu for actions with loading state",
  "dependencies": [
    "lucide-react",
    "@tanstack/react-query"
  ],
  "registryDependencies": [
    "dropdown-menu",
    "button"
  ],
  "files": [
    {
      "path": "registry/default/components/dropdown-menu/action-with-loading-dropdown.tsx",
      "content": "'use client'\n\nimport { Button } from '@/registry/default/ui/button'\nimport {\n    DropdownMenu,\n    DropdownMenuContent,\n    DropdownMenuGroup,\n    DropdownMenuItem,\n    DropdownMenuLabel,\n    DropdownMenuSeparator,\n    DropdownMenuShortcut,\n    DropdownMenuTrigger,\n} from '@/registry/default/ui/dropdown-menu'\nimport { useMutation } from '@tanstack/react-query'\nimport {\n    EllipsisIcon,\n    Loader2Icon,\n    LockIcon,\n    ScanSearchIcon,\n    SquarePenIcon,\n    Trash2Icon,\n} from 'lucide-react'\nimport React, { Dispatch, JSX, SetStateAction } from 'react'\n\ntype ActionDropdownProps = {\n    align?: 'start' | 'end' | 'center'\n    side?: 'top' | 'right' | 'bottom' | 'left'\n}\n\ntype ComponentProps = {\n    open: boolean\n    setOpen: Dispatch<SetStateAction<boolean>>\n}\n\ntype Item = {\n    id: string\n    subItems: {\n        id: string\n        icon: React.ReactNode\n        variant?: 'destructive' | 'default'\n        Component: ({ open, setOpen }: ComponentProps) => JSX.Element\n    }[]\n}\n\nconst items: Item[] = [\n    {\n        id: 'general',\n        subItems: [\n            {\n                id: 'edit',\n                icon: <SquarePenIcon />,\n                Component: EditItem,\n            },\n            {\n                id: 'view',\n                icon: <ScanSearchIcon />,\n                Component: ViewItem,\n            },\n            {\n                id: 'block',\n                icon: <LockIcon />,\n                Component: BlockItem,\n            },\n        ],\n    },\n    {\n        id: 'destructive',\n        subItems: [\n            {\n                id: 'delete',\n                icon: <Trash2Icon />,\n                Component: DeleteItem,\n                variant: 'destructive',\n            },\n        ],\n    },\n]\n\nexport default function ActionWithLoadingDropdown({\n    align = 'end',\n    side = 'bottom',\n}: ActionDropdownProps) {\n    const [open, setOpen] = React.useState(false)\n\n    return (\n        <DropdownMenu open={open} onOpenChange={setOpen}>\n            <DropdownMenuTrigger asChild>\n                <Button variant=\"outline\" className=\"cursor-pointer\">\n                    <span>Actions with loading</span>\n                    <EllipsisIcon />\n                </Button>\n            </DropdownMenuTrigger>\n            <DropdownMenuContent\n                align={align}\n                side={side}\n                className=\"w-[200px]\"\n            >\n                <DropdownMenuLabel>Actions</DropdownMenuLabel>\n                <DropdownMenuSeparator />\n                {items.map((item, index) => (\n                    <DropdownMenuGroup key={item.id}>\n                        {item.subItems.map(({ Component, id }) => (\n                            <Component open={open} setOpen={setOpen} key={id} />\n                        ))}\n                        {index < items.length - 1 && <DropdownMenuSeparator />}\n                    </DropdownMenuGroup>\n                ))}\n            </DropdownMenuContent>\n        </DropdownMenu>\n    )\n}\n\nfunction EditItem({ setOpen }: ComponentProps) {\n    const { isPending, mutate } = useMutation({\n        mutationFn: async () => {\n            return new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve('Edit')\n                }, 1000)\n            })\n        },\n        onSuccess: () => {\n            console.log(`Mutation successful: Edit`)\n        },\n        onError: () => {\n            console.log(`Mutation failed: Edit`)\n        },\n        onSettled: () => {\n            setOpen(false)\n        },\n    })\n\n    return (\n        <DropdownMenuItem\n            onSelect={(e) => {\n                e.preventDefault()\n                console.log('Edit clicked')\n                mutate()\n            }}\n            disabled={isPending}\n        >\n            {isPending ? (\n                <Loader2Icon className=\"animate-spin\" />\n            ) : (\n                <SquarePenIcon />\n            )}\n            <span className=\"flex-1\">Edit</span>\n            <DropdownMenuShortcut>E</DropdownMenuShortcut>\n        </DropdownMenuItem>\n    )\n}\n\nfunction ViewItem({ setOpen }: ComponentProps) {\n    const { isPending, mutate } = useMutation({\n        mutationFn: async () => {\n            return new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve('View')\n                }, 1000)\n            })\n        },\n        onSuccess: () => {\n            console.log(`Mutation successful: View`)\n        },\n        onError: () => {\n            console.log(`Mutation failed: View`)\n        },\n        onSettled: () => {\n            setOpen(false)\n        },\n    })\n\n    return (\n        <DropdownMenuItem\n            onSelect={(e) => {\n                e.preventDefault()\n                console.log('View clicked')\n                mutate()\n            }}\n            disabled={isPending}\n        >\n            {isPending ? (\n                <Loader2Icon className=\"animate-spin\" />\n            ) : (\n                <ScanSearchIcon />\n            )}\n            <span className=\"flex-1\">View</span>\n            <DropdownMenuShortcut>V</DropdownMenuShortcut>\n        </DropdownMenuItem>\n    )\n}\n\nfunction BlockItem({ setOpen }: ComponentProps) {\n    const { isPending, mutate } = useMutation({\n        mutationFn: async () => {\n            return new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve('Block')\n                }, 1000)\n            })\n        },\n        onSuccess: () => {\n            console.log(`Mutation successful: Block`)\n        },\n        onError: () => {\n            console.log(`Mutation failed: Block`)\n        },\n        onSettled: () => {\n            setOpen(false)\n        },\n    })\n\n    return (\n        <DropdownMenuItem\n            onSelect={(e) => {\n                e.preventDefault()\n                console.log('Block clicked')\n                mutate()\n            }}\n            disabled={isPending}\n        >\n            {isPending ? (\n                <Loader2Icon className=\"animate-spin\" />\n            ) : (\n                <LockIcon />\n            )}\n            <span className=\"flex-1\">Block</span>\n            <DropdownMenuShortcut>B</DropdownMenuShortcut>\n        </DropdownMenuItem>\n    )\n}\n\nfunction DeleteItem({ setOpen }: ComponentProps) {\n    const { isPending, mutate } = useMutation({\n        mutationFn: async () => {\n            return new Promise((resolve) => {\n                setTimeout(() => {\n                    resolve('Delete')\n                }, 1000)\n            })\n        },\n        onSuccess: () => {\n            console.log(`Mutation successful: Delete`)\n        },\n        onError: () => {\n            console.log(`Mutation failed: Delete`)\n        },\n        onSettled: () => {\n            setOpen(false)\n        },\n    })\n\n    return (\n        <DropdownMenuItem\n            onSelect={(e) => {\n                e.preventDefault()\n                console.log('Delete clicked')\n                mutate()\n            }}\n            variant=\"destructive\"\n            disabled={isPending}\n        >\n            {isPending ? (\n                <Loader2Icon className=\"animate-spin\" />\n            ) : (\n                <Trash2Icon />\n            )}\n            <span className=\"flex-1\">Delete</span>\n            <DropdownMenuShortcut className=\"text-destructive\">\n                D\n            </DropdownMenuShortcut>\n        </DropdownMenuItem>\n    )\n}\n",
      "type": "registry:component",
      "target": "components/action-with-loading-dropdown.tsx"
    }
  ]
}